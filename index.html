<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islam | by Ayynan</title>
<meta name="description" content="A platform for sharing Islamic reminders and content by Ayynan.">
<meta name="keywords" content="Islam, Quran, Reminders, Ayynan">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        h1, h2 {
    scroll-margin-top: 80px; /* This keeps the heading from being hidden under the bar */
}
        html {
    scroll-behavior: smooth;
}
       /* 1. REPLACE your old .navbar, .nav-container, and .nav-link with THIS */
/* DASHING FULL-WIDTH NAVBAR */
.navbar {
    position: fixed; /* Fixes it to the absolute top */
    top: 0;
    left: 0;
    width: 100%; /* Touches both sides */
    background: var(--card-bg);
    border-bottom: 3px solid var(--btn-primary); /* The dashing outline */
    box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
    z-index: 9999;
    padding: 12px 0;
    transition: all 0.3s ease;
}
/* Glassmorphism for the bar */
.navbar {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}
[data-theme="dark"] .navbar {
    background: rgba(18, 18, 18, 0.9);
    border-bottom: 3px solid var(--btn-primary);
}
.nav-container {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between; 
    align-items: center;
    padding: 0 30px;
}
/* Add these new rules immediately after the .nav-container block */
.nav-logo { flex: 1; display: flex; justify-content: flex-start; }
.nav-links { flex: 1; display: flex; justify-content: center; gap: 30px; }
.nav-toggle-wrapper { flex: 1; display: flex; justify-content: flex-end; }
/* This centers the links specifically */
.nav-links {
    display: flex;
    gap: 30px;
    /* Remove any margin-left or margin-right from here */
}
/* Makes sure the button stays on the far right */
#theme-toggle {
    position: static;
    background: var(--text-color);
    color: var(--card-bg);
    border: none;
    width: 38px;
    height: 38px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: 0.3s;
}
.nav-link {
    text-decoration: none;
    color: var(--text-color);
    font-size: 13px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.7;
    transition: 0.3s;
}
.nav-link:hover {
    opacity: 1;
    color: var(--btn-primary);
    transform: translateY(-2px);
}
/* CLEANED UP BODY */
        :root {
            --bg-color: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --text-color: #1c1e21;
            --card-bg: white;
            --btn-primary: #007bff;
            --accent-bg: rgba(0, 123, 255, 0.1);
        }
        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #ffffff;
            --card-bg: #1e1e1e;
            --btn-primary: #3793ff;
            --accent-bg: rgba(255, 255, 255, 0.15);
        }
        body {
    font-family: 'Segoe UI', sans-serif;
    text-align: center;
    background: var(--bg-color);
    min-height: 100vh;
    color: var(--text-color);
    margin: 0; 
    /* This is the "Sweet Spot" - enough for a gap, but not too much */
    padding: 100px 20px 40px 20px; 
    transition: background 0.5s ease;
}
        #theme-toggle {
    position: static; /* No longer floating at bottom-right */
    background: var(--text-color);
    color: var(--card-bg);
    border: none;
    padding: 8px;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: 0.3s;
}
        .container { max-width: 500px; margin: 0 auto; }
        img.profile-pic { border-radius: 50%; border: 5px solid white; width: 140px; height: 140px; object-fit: cover; margin-bottom: 10px; }

        /* KSA CLOCK */
        .clock-container { display: flex; flex-direction: column; align-items: center; margin: 15px 0; }
        .clock {
            width: 70px; height: 70px; border: 3px solid var(--btn-primary);
            border-radius: 50%; position: relative; background: var(--card-bg);
        }
        .hand { position: absolute; bottom: 50%; left: 50%; transform-origin: bottom; background: var(--text-color); border-radius: 4px; transform: translateX(-50%); }
        .hour { width: 3px; height: 25%; z-index: 3; }
        .min { width: 2px; height: 35%; z-index: 2; }
        .sec { width: 1px; height: 40%; background: #ff4757; z-index: 1; }
        .center-dot { position: absolute; top: 50%; left: 50%; width: 6px; height: 6px; background: var(--btn-primary); border-radius: 50%; transform: translate(-50%, -50%); z-index: 4; }
        .clock-label { font-size: 10px; font-weight: bold; margin-top: 5px; color: var(--btn-primary); }
        /* WELCOME BOX */
        .welcome-intro {
            background: var(--accent-bg); padding: 22px; border-radius: 15px;
            margin: 20px 0; text-align: left; line-height: 1.6;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .intro-header {
            display: flex; align-items: center; gap: 10px;
            font-weight: 800; color: var(--btn-primary);
            margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; font-size: 14px;
        }
        .arrow-prompt { font-size: 16px; font-weight: bold; color: var(--btn-primary); }
        /* SKILLS */
        .skills-bar { display: flex; justify-content: center; gap: 20px; font-size: 26px; margin: 20px 0; }
        .skills-bar i { transition: transform 0.2s; cursor: help; }
        .skills-bar i:hover { transform: scale(1.2); color: var(--btn-primary); }
        /* BIG BOX FEATURES */
        .section-title { margin-top: 35px; font-size: 20px; border-bottom: 3px solid var(--btn-primary); display: inline-block; padding-bottom: 5px; margin-bottom: 20px; }
        .grid-layout { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 10px; width: 100%; }
        .card-link { text-decoration: none; color: inherit; display: block; }
        .feature-card { 
            background: var(--card-bg); padding: 25px 15px; border-radius: 15px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: 0.3s; 
            min-height: 120px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-sizing: border-box;
        }
        .feature-card:hover { transform: translateY(-8px); background: var(--accent-bg); border: 1px solid var(--btn-primary); }
        .feature-card i { font-size: 32px; margin-bottom: 12px; }
        .feature-card h3 { margin: 0; font-size: 16px; font-weight: 600; }
        /* MAIN BUTTONS */
        .main-btn { 
            background-color: var(--btn-primary); color: white; border: none; 
            padding: 16px; border-radius: 30px; font-size: 18px; font-weight: bold; 
            cursor: pointer; width: 100%; display: flex; align-items: center; justify-content: center; 
            gap: 10px; text-decoration: none; margin-bottom: 15px; transition: 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .main-btn:hover { transform: translateY(-5px); filter: brightness(1.1); box-shadow: 0 8px 15px rgba(0,0,0,0.15); }

        form { background: var(--card-bg); padding: 20px; border-radius: 15px; display: flex; flex-direction: column; gap: 10px; margin-top: 10px; }
        input, textarea { padding: 10px; border-radius: 8px; border: 1px solid #ddd; background: var(--card-bg); color: var(--text-color); font-family: inherit; }
        /* UPDATED PROFESSIONAL FOOTER */
        footer { margin-top: 40px; padding-bottom: 40px; }
        .final-msg { font-style: italic; font-weight: bold; color: var(--btn-primary); font-size: 18px; margin-bottom: 15px; }
        
        /* Better, Custom "System Counter" Look */
        .system-footer {
            display: inline-block; padding: 10px 20px; background: var(--card-bg);
            border-radius: 10px; border-left: 4px solid var(--btn-primary);
            text-align: left; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .sys-line { font-family: 'Courier New', monospace; font-size: 12px; color: var(--text-color); opacity: 0.7; margin: 2px 0; }
        .sys-val { color: var(--btn-primary); font-weight: bold; }
    /* Mobile Logic */
@media (max-width: 768px) {
    .nav-links {
        display: none; /* Hide links by default on mobile */
        flex-direction: column;
        position: absolute;
        top: 60px;
        left: 0;
        width: 100%;
        background: var(--card-bg);
        padding: 20px;
        border-bottom: 2px solid var(--btn-primary);
    }
    .nav-links.active {
        display: flex; /* Show links when "active" class is added */
    }
    .menu-icon {
        display: block; /* Show hamburger icon */
        cursor: pointer;
        font-size: 24px;
        flex: 1;
    }
    .nav-logo { flex: 2; justify-content: center; } /* Center logo on mobile */
}

@media (min-width: 769px) {
    .menu-icon { display: none; } /* Hide hamburger on desktop */
}
.modal { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); }
.modal-content { background: var(--card-bg); margin: 5% auto; padding: 20px; border-radius: 20px; width: 90%; max-width: 800px; max-height: 80vh; overflow-y: auto; position: relative; }
.close-modal { position: absolute; right: 20px; top: 10px; font-size: 30px; cursor: pointer; color: var(--text-color); }
.surah-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 15px;
    padding: 20px 0; /* Creates breathing room below the header */
}
.surah-card { background: var(--accent-bg); padding: 15px; border-radius: 10px; cursor: pointer; transition: 0.3s; border: 1px solid transparent; }
.surah-card:hover { border-color: var(--btn-primary); transform: scale(1.05); }
.quran-text-container { font-family: 'Amiri', serif; font-size: 24px; line-height: 2.5; text-align: right; padding: 20px; direction: rtl; }
   .spinner {
    width: 40px;
    height: 40px;
    border: 4px solid rgba(0, 123, 255, 0.1);
    border-left-color: var(--btn-primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 20px auto;
}
@keyframes spin { to { transform: rotate(360deg); } }
/* THE FIXED HEADER BAR */
.modal-nav {
    position: sticky;
    top: 0; /* Change from -20px to 0 */
    background: var(--card-bg);
    z-index: 1000;
}

.nav-left-group {
    display: flex;
    align-items: center;
    gap: 10px;
}

#audio-container audio {
    height: 30px;
    width: 180px; /* Kept small to save space */
}

/* Make sure the title doesn't take up too much space */
.modal-nav h2 {
    font-size: 1.2rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
@media (max-width: 600px) {
    .modal-nav {
        flex-wrap: wrap; /* Allows audio player to drop to a second line if the screen is too narrow */
        justify-content: space-between;
    }
    #surah-audio {
        width: 100%; /* Makes audio player full width on small phones */
        margin-top: 10px;
    }
}
.audio-controls {
    display: flex;
    align-items: center;
    background: var(--accent-bg);
    padding: 5px 10px;
    border-radius: 50px; /* Makes it look like a pill */
    gap: 5px;
}

.skip-btn {
    background: transparent;
    border: none;
    color: var(--btn-primary);
    cursor: pointer;
    font-size: 16px;
    padding: 5px 10px;
    transition: 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.skip-btn:hover {
    color: var(--text-color);
    transform: scale(1.1);
}
/* Container to keep everything in one row */
.skip-control-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    margin-top: 5px;
}

/* Compact buttons that won't stack */
.compact-skip {
    background: #444;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 5px 12px;
    font-size: 12px;
    cursor: pointer;
    white-space: nowrap; /* Prevents text from wrapping */
    transition: 0.2s;
}

.compact-skip:hover {
    background: var(--btn-primary);
}

/* Ensures the audio player has enough room for the 3 dots */
#surah-audio {
    height: 35px;
    flex-grow: 1; /* Makes the player take up available space */
    min-width: 200px; /* Essential to show the three-dot menu */
}

@media (max-width: 480px) {
    #surah-audio {
        min-width: 150px; /* Smaller for mobile but still visible */
    }
}
.quran-player-bar {
    display: flex !important; /* Force flexbox */
    flex-direction: row !important; /* Force horizontal */
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: 100%;
    padding: 5px 0;
}

.player-btn {
    background: #444;
    color: white;
    border: none;
    border-radius: 15px;
    padding: 6px 10px;
    font-size: 11px;
    cursor: pointer;
    white-space: nowrap; /* Prevents the text from splitting into two lines */
    min-width: 45px;
}

#surah-audio {
    height: 35px;
    flex-grow: 1; /* Tells the player to take up all middle space */
    min-width: 220px; /* IMPORTANT: This is the minimum width needed for the 3 dots to appear */
}

/* On very small phones, hide the labels to save space for the 3 dots */
@media (max-width: 400px) {
    .player-btn {
        font-size: 10px;
        padding: 5px;
    }
    #surah-audio {
        min-width: 180px;
    }
}
/* Hide the standard browser "download" button to save space */
audio::-webkit-media-controls-enclosure {
    background-color: transparent;
}
#surah-list {
    display: grid !important;
    /* This creates a grid that automatically adds columns */
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)) !important; 
    gap: 15px !important;
    padding: 20px !important;
    width: 100% !important;
    box-sizing: border-box !important;
}

/* Ensure the cards themselves don't stretch weirdly */
.surah-card {
    display: flex !important;
    flex-direction: row !important; /* Internal card content stays horizontal */
    justify-content: space-between;
    align-items: center;
    height: auto;
}
.ayah-block {
    display: flex;
    flex-direction: column;
    gap: 5px;
}
.arabic-text {
    line-height: 1.8;
    color: var(--text-color);
}
.trans-text {
    line-height: 1.5;
    color: var(--btn-primary);
    font-style: italic;
}
/* Container for each Verse + Translation pair */
.ayah-block {
    padding: 20px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* High-quality Arabic styling */
.arabic-text {
    direction: rtl;
    text-align: right;
    font-family: 'Amiri', serif;
    font-size: 28px;
    line-height: 2;
    color: #fff;
}

/* Styling for English/Urdu translations */
.trans-text {
    font-size: 18px;
    line-height: 1.6;
    color: var(--btn-primary); /* Uses your theme color */
}

/* Tafseer Button Styling */
.tafseer-btn {
    background: #444;
    color: #00d4ff;
    border: 1px solid #00d4ff;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 13px;
    align-self: flex-start; /* Keeps button on the side */
    transition: 0.3s;
}

.tafseer-btn:hover {
    background: #00d4ff;
    color: #000;
}
/* Forces the buttons to be small and side-by-side */
.player-btn, .compact-skip {
    display: inline-block !important;
    width: auto !important;
    margin: 0 5px !important;
}
#audio-container {
    display: none; /* Keep it hidden until loadSurah is called */
    width: 100%;
    margin-bottom: 15px;
}
/* 1. Ensure the container is visible and text is readable */
#surah-text {
    display: block !important;
    color: var(--text-color) !important; /* Fixes invisible text in dark mode */
    padding: 20px;
}
/* 2. Fix the "White on White" or "Dark on Dark" text bug */
.ayah-block {
    background: var(--card-bg); /* Matches your theme */
    padding: 20px;
    border-bottom: 1px solid var(--btn-primary);
    margin-bottom: 10px;
    border-radius: 8px;
}

/* 3. High-Quality Arabic Font */
.arabic-text {
    direction: rtl;
    text-align: right;
    font-family: 'Amiri', serif;
    font-size: 28px;
    line-height: 2.2;
    color: var(--text-color) !important;
    margin-bottom: 15px;
}

/* 4. Translation text styling */
.trans-text {
    direction: ltr;
    text-align: left;
    font-size: 16px;
    color: var(--btn-primary);
    line-height: 1.6;
    margin-top: 10px;
}
   </style>
</head>
<body>
<nav class="navbar">
    <div class="nav-container">
        <div class="nav-logo" >
             <span>‚ñ∂AYYNAN</span>
        </div>
        <div class="nav-links">
            <a href="#home" class="nav-link">Home</a>
            <a href="#development" class="nav-link">Development</a>
            <a href="#islam" class="nav-link">Islam</a>
            <a href="#contact" class="nav-link">Contact Us</a>
        </div>
        <div class="nav-toggle-wrapper">
            <button id="theme-toggle" onclick="toggleTheme()">üåô</button>
        </div>
    </div>
    <div class="menu-icon" onclick="toggleMenu()">
    <i class="fas fa-bars"></i>
</div>
</nav>
    <div class="container">
        <img src="me.jpg" alt="Ayynan" class="profile-pic" id="home">
        <h1>Ayynan.codes</h1>
        <div class="clock-container">
            <div class="clock">
                <div class="center-dot"></div>
                <div id="hour" class="hand hour"></div>
                <div id="min" class="hand min"></div>
                <div id="sec" class="hand sec"></div>
            </div>
            <div class="clock-label">KSA TIME</div>
        </div>
        <div class="welcome-intro">
            <div class="intro-header"><span class="arrow-prompt">‚û§</span> SYSTEM ONLINE</div>
            <div>Hi, I'm <strong>Ayynan</strong>. I'm a developer building fast, responsive, and modern web experiences. <strong>Check out the features and tech stack I've used below!</strong></div>
        </div>
        <div class="skills-bar">
            <i class="fab fa-html5" title="HTML5"></i>
            <i class="fab fa-css3-alt" title="CSS3"></i>
            <i class="fab fa-js" title="JavaScript"></i>
            <i class="fab fa-github" title="GitHub"></i>
            <i class="fab fa-python" title="Python"></i>
            <i class="fas fa-dragon" title="Dragon Game Engine"></i>
        </div>
        <a href="https://github.com/Ayynan" target="_blank" class="main-btn">
            <i class="fab fa-github"></i> GitHub Profile
        </a>
        <a href="https://www.youtube.com/channel/UCKAK0xKz0c1oAJ3I2SUApHg" target="_blank" class="main-btn" style="background-color: #ff0000;">
            <i class="fab fa-youtube"></i> YouTube Channel
        </a>
        <h2 class="section-title" id="development">Development</h2>
        <div class="grid-layout">
            <a href="https://github.com/Ayynan/ayynan.github.io" target="_blank" class="card-link">
                <div class="feature-card">
                    <i class="fas fa-code" style="color: var(--btn-primary);"></i>
                    <h3>Site Source</h3>
                </div>
            </a>
            <a href="https://github.com/Ayynan" target="_blank" class="card-link">
                <div class="feature-card">
                    <i class="fas fa-folder-open" style="color: #ffaa00;"></i>
                    <h3>My Projects</h3>
                </div>
            </a>
        </div>
        <h2 class="section-title" id="islam">Islam</h2>
<div class="grid-layout">
    <a href="#" onclick="openQuran(event)" class="card-link">
        <div class="feature-card">
            <i class="fas fa-book-open" style="color: #2e7d32;"></i> 
            <h3>Quran</h3>
        </div>
    </a>
    <a href="audio.mp3" target="_blank" class="card-link">
        <div class="feature-card">
            <i class="fas fa-scroll" style="color: #1b5e20;"></i> 
            <h3>Hadith</h3>
        </div>
    </a>
</div>
        <h2 class="section-title" id="contact">Contact</h2>
        <form action="https://formspree.io/f/ayynanwaheed2021@gmail.com" method="POST">
            <input type="text" name="name" placeholder="Name" required>
            <input type="email" name="email" placeholder="Email" required>
            <textarea name="message" rows="3" placeholder="Message" required></textarea>
            <button type="submit" class="main-btn">Send Message</button>
        </form>
        <footer>
            <div class="final-msg">"Coding is my language."</div>
            <div class="system-footer">
                <div class="sys-line">STATUS: <span class="sys-val">ONLINE</span></div>
                <div class="sys-line">USER: <span class="sys-val">AYYNAN_V1.0</span></div>
                <div class="sys-line">TOTAL_LOADS: <span class="sys-val" id="load-count">...</span></div>
            </div>
        </footer>
    </div>
    <div id="quran-modal" class="modal">
        <div class="modal-content">
            <div class="modal-nav">
                <div class="nav-left-group" style="display: flex; align-items: center; gap: 15px;">
                    <div id="back-btn-container" style="display:none;">
                        <button onclick="goBack()" class="main-btn" style="width:auto; padding:8px 12px; margin:0;">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                    <div id="close-btn-container">
                        <button onclick="closeQuran()" class="main-btn" style="width:auto; padding:8px 12px; margin:0; background:#666;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <h2 id="surah-title" style="margin:0; font-size: 1.1rem;">Holy Quran</h2>
                </div>
            </div>

            <div id="audio-container" style="display:none; flex-direction: column; align-items: center; padding: 15px; background: var(--accent-bg); border-radius: 10px; margin: 15px 0;">
                <div style="margin-bottom: 10px; width: 100%;">
                    <label style="font-size: 11px; font-weight: bold; opacity: 0.7;">SELECT RECITER</label>
                    <select id="reciter-select" onchange="changeReciter()" style="width: 100%; padding: 8px; border-radius: 5px; background: var(--card-bg); color: var(--text-color);">
                        <option value="https://server8.mp3quran.net/afs/">Mishary Rashid Alafasy</option>
                        <option value="https://server11.mp3quran.net/sds/">Abdurrahmaan As-Sudais</option>
                        <option value="https://server6.mp3quran.net/shur/">Saud Al-Shuraim</option>
                        <option value="https://server13.mp3quran.net/yasser/">Yasser Al-Dosari</option>
                    </select>
                </div>
                <audio id="surah-audio" controls style="width: 100%;"></audio>
            </div>

            <div id="language-settings" style="display:none; margin: 10px 0; text-align: center; background: var(--accent-bg); padding: 10px; border-radius: 10px;">
    <label style="font-size: 14px; font-weight: bold;">Translation: </label>
    <select id="view-mode" onchange="fetchContent()" style="padding: 5px; border-radius: 5px; background: var(--card-bg); color: var(--text-color);">
        <option value="ar">Arabic Only</option>
        <option value="en">Arabic + English</option>
        <option value="ur">Arabic + Urdu</option>
    </select>
</div>

            <div id="surah-list-container">
                <div id="surah-list" class="surah-grid">
                    </div>
            </div>

            <div id="surah-display-container" style="display:none;">
                <div id="surah-text" style="padding: 10px; min-height: 200px;">
                    </div>
            </div>
        </div> </div> <div id="tafseer-modal" class="modal" style="display:none; z-index: 99999;">
        <div class="modal-content" style="max-width: 600px; border-radius: 15px;">
            <div class="modal-nav">
                <h2 id="tafseer-title">Tafseer</h2>
                <button onclick="closeTafseer()" class="main-btn" style="width:auto; background:#666; border-radius: 50%; padding: 5px 10px;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="tafseer-content" style="padding: 20px; line-height: 1.8; color: var(--text-color);">
                Loading...
            </div>
        </div>
    </div>
    <script>
       /* --- SYSTEM & UI LOGIC --- */
let visits = localStorage.getItem('visit_count') || 0;
visits++;
localStorage.setItem('visit_count', visits);
if(document.getElementById('load-count')) {
    document.getElementById('load-count').innerText = visits.toString().padStart(5, '0');
}

function toggleTheme() {
    const body = document.documentElement;
    const isDark = body.getAttribute("data-theme") === "dark";
    body.setAttribute("data-theme", isDark ? "" : "dark");
    document.getElementById("theme-toggle").innerHTML = isDark ? "üåô" : "‚òÄÔ∏è";
}

function setClock() {
    const now = new Date();
    const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
    const ksaNow = new Date(utc + (3600000 * 3));
    const secondsRatio = ksaNow.getSeconds() / 60;
    const minutesRatio = (secondsRatio + ksaNow.getMinutes()) / 60;
    const hoursRatio = (minutesRatio + ksaNow.getHours()) / 12;
    setRotation(document.getElementById('sec'), secondsRatio);
    setRotation(document.getElementById('min'), minutesRatio);
    setRotation(document.getElementById('hour'), hoursRatio);
}

function setRotation(element, rotationRatio) {
    if(element) element.style.setProperty('transform', `translateX(-50%) rotate(${rotationRatio * 360}deg)`);
}
setInterval(setClock, 1000);
setClock();

function toggleMenu() {
    document.querySelector('.nav-links').classList.toggle('active');
}

/* --- QURAN CORE LOGIC --- */
window.currentSurahId = 1;

// 1. Open Quran Modal
window.openQuran = function(e) {
    if(e) e.preventDefault();
    document.getElementById('quran-modal').style.display = 'block';
    window.goBack(); // Start at the list view
    fetchSurahs(); 
};

// 2. Fetch the list of 114 Surahs
async function fetchSurahs() {
    const list = document.getElementById('surah-list');
    if (!list || list.innerHTML.trim() !== "") return; 

    list.innerHTML = '<div style="grid-column: 1/-1; text-align:center; padding:20px;">Loading Surahs...</div>';
    
    try {
        const res = await fetch('https://api.alquran.cloud/v1/surah');
        const data = await res.json();
        list.innerHTML = '';
        data.data.forEach(surah => {
            const card = document.createElement('div');
            card.className = 'surah-card';
            card.innerHTML = `
                <div class="surah-info">
                    <span class="surah-number">${surah.number}</span>
                    <div>
                        <h4 style="margin:0;">${surah.englishName}</h4>
                        <small>${surah.name}</small>
                    </div>
                </div>`;
            card.onclick = () => loadSurah(surah.number, surah.englishName);
            list.appendChild(card);
        });
    } catch (err) {
        list.innerHTML = "Error loading list.";
    }
}

// 3. Load a specific Surah
window.loadSurah = async function(id, name) {
    window.currentSurahId = id;
    
    document.getElementById('surah-list-container').style.display = 'none';
    document.getElementById('surah-display-container').style.display = 'block';
    
    // --- SHOW THE UI ELEMENTS ---
    document.getElementById('audio-container').style.display = 'flex';
    document.getElementById('language-settings').style.display = 'block'; // SHOW BAR
    document.getElementById('back-btn-container').style.display = 'block';
    document.getElementById('close-btn-container').style.display = 'none';
    
    document.getElementById('surah-title').innerText = name;

    window.changeReciter(); 
    window.fetchContent(); 
};

// 4. Fetch Verses
window.fetchContent = async function() {
    const display = document.getElementById('surah-text');
    const mode = document.getElementById('view-mode').value;
    
    if(!display) return;
    display.innerHTML = '<p style="text-align:center; padding:20px;">Loading Ayahs...</p>';

    try {
        const response = await fetch(`https://api.alquran.cloud/v1/surah/${window.currentSurahId}/editions/quran-uthmani,en.sahih,ur.jalandhry`);
        const result = await response.json();

        if (result.code === 200) {
            let html = "";
            const ar = result.data[0].ayahs;
            const en = result.data[1].ayahs;
            const ur = result.data[2].ayahs;

            ar.forEach((ayah, i) => {
                const num = i + 1;
                let translation = "";
                let alignment = "left";
                let dir = "ltr";

                // Set logic for English vs Urdu alignment
                if (mode === "en") {
                    translation = en[i].text;
                    alignment = "left";
                    dir = "ltr";
                } else if (mode === "ur") {
                    translation = ur[i].text;
                    alignment = "right";
                    dir = "rtl";
                }

                html += `
                    <div class="ayah-block" style="margin-bottom: 40px; border-bottom: 1px solid var(--accent-bg); padding-bottom: 25px;">
                        <p style="font-size: 28px; text-align: right; direction: rtl; line-height: 2.2; font-family: 'Amiri', serif; color: var(--text-color); margin-bottom: 15px;">
                            ${ayah.text} <span style="color: var(--btn-primary); font-size: 18px;">(${num})</span>
                        </p>

                        <p style="font-size: 17px; color: var(--text-color); opacity: 0.9; text-align: ${alignment}; direction: ${dir}; line-height: 1.8; margin-bottom: 15px;">
                            ${translation}
                        </p>
                        
                        <div style="text-align: center; margin-top: 10px;">
                            <button onclick="window.showTafseer(${window.currentSurahId}, ${num})" 
                                    style="background: transparent; color: var(--btn-primary); border: 1px solid var(--btn-primary); padding: 5px 15px; border-radius: 20px; cursor: pointer; font-size: 11px; font-weight: bold; text-transform: uppercase;">
                                <i class="fas fa-book-open"></i> View Tafseer
                            </button>
                        </div>
                    </div>`;
            });
            display.innerHTML = html;
        }
    } catch (e) {
        display.innerHTML = '<p style="color:red; text-align:center;">Failed to load text.</p>';
    }
};

// 5. Navigation Control (Back to List)
window.goBack = function() {
    document.getElementById('surah-title').innerText = "Holy Quran";

    document.getElementById('surah-list-container').style.display = 'block';
    document.getElementById('surah-display-container').style.display = 'none';
    
    // --- HIDE THE UI ELEMENTS ---
    document.getElementById('audio-container').style.display = 'none';
    document.getElementById('language-settings').style.display = 'none'; // HIDE BAR
    document.getElementById('back-btn-container').style.display = 'none';
    document.getElementById('close-btn-container').style.display = 'block';

    const player = document.getElementById('surah-audio');
    if (player) {
        player.pause();
        player.src = "";
    }
};
window.closeQuran = function() {
    document.getElementById('quran-modal').style.display = 'none';
    const player = document.getElementById('surah-audio');
    if (player) player.pause();
};

/* --- AUDIO LOGIC --- */
window.changeReciter = function() {
    const player = document.getElementById('surah-audio');
    const reciterBaseUrl = document.getElementById('reciter-select').value;
    const paddedId = window.currentSurahId.toString().padStart(3, '0');
    player.src = reciterBaseUrl + paddedId + ".mp3";
    player.load();
};
window.showTafseer = async function(surah, ayah) {
    const modal = document.getElementById('tafseer-modal');
    const content = document.getElementById('tafseer-content');
    const title = document.getElementById('tafseer-title');
    const mode = document.getElementById('view-mode').value;
    
    // 1. Show modal and loading state
    modal.style.display = 'block';
    content.innerHTML = '<div style="text-align:center; padding:20px;"><i class="fas fa-spinner fa-spin"></i> Loading Tafseer...</div>';
    title.innerText = `Tafseer - Ayah ${ayah}`;

    // 2. Choose edition (English or Urdu)
    let edition = (mode === 'ur') ? 'ur.jalandhry' : 'en.ahmedali';
    content.style.textAlign = (mode === 'ur') ? 'right' : 'left';
    content.style.direction = (mode === 'ur') ? 'rtl' : 'ltr';

    try {
        // Fetch from API
        const response = await fetch(`https://api.alquran.cloud/v1/ayah/${surah}:${ayah}/${edition}`);
        const result = await response.json();
        
        if(result.code === 200) {
            content.innerHTML = `<div style="font-size: 18px; padding: 10px;">${result.data.text}</div>`;
        } else {
            content.innerHTML = "Tafseer not available for this verse.";
        }
    } catch (error) {
        content.innerHTML = "Connection error. Please try again.";
    }
};
window.closeTafseer = function() {
    const modal = document.getElementById('tafseer-modal');
    if (modal) {
        modal.style.display = 'none';
    }
};
window.onclick = function(event) {
    const quranModal = document.getElementById('quran-modal');
    const tafseerModal = document.getElementById('tafseer-modal');
    
    if (event.target == quranModal) {
        closeQuran();
    }
    if (event.target == tafseerModal) {
        closeTafseer();
    }
};
    </script>
</body>
</html>